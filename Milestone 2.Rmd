---
title: "Milestone 2"
author: "Caitlin Bolz, Faith Kulzer, Samuel Peters, and Steven Xia"
date: "3/7/2021"
output: html_document
---

```{r, echo=FALSE, message=FALSE}
library("readr")
library("dplyr")
library("tidyr")
```

```{r, message=FALSE}
# Contains names of plants and animals, as well as endangerment status, in NY at the county level
biodiversity = read_csv("Biodiversity_by_County_-_Distribution_of_Animals__Plants_and_Natural_Communities.csv")

# Contains estimations for human populations and growth rate in each NY county
countyPop = read_csv("NYCounties.csv")

# Contains estimated land mass of NY counties from 2010
# Areas are in square miles
countyArea = read_csv("NYCountyArea.csv")
```

```{r, warning=FALSE}
# Clean county population dataset
countyPop = countyPop %>% 
  extract(CTYNAME, into = "county", regex = "(.*)(?= County)") %>% 
  rename(human_pop_county = pop2021, human_growth_rate = GrowthRate)

# Clean county areas dataset
countyArea = countyArea %>% 
  select(BASENAME, AREALAND, AREAWATER) %>% 
  rename(county = BASENAME,
         land_area = AREALAND,
         water_area = AREAWATER)

# Change spaces into underscores and make lowercase for biodiversity column names
names(biodiversity) = gsub(" ", "_", tolower(names(biodiversity)))

# Clean the biodiversity dataset and join with other datasets
biodiversity = biodiversity %>% 
  # Remove unwanted columns
  select(everything(), 
         -ny_listing_status, 
         -federal_listing_status, 
         -distribution_status, 
         -year_last_documented,
         -scientific_name) %>% 
  # Remove non-plant/animal entries as well as non-county entries
  filter(category != "Natural Community", 
         category != "not listed", 
         taxonomic_group != "Animal Assemblages",
         county %in% countyPop$county) %>% 
  left_join(countyPop, by = "county") %>% 
  left_join(countyArea, by = "county") %>% 
  # Create pop/mi^2
  mutate(pop_per_mi = human_pop_county / (land_area + water_area))
```

```{r, echo=FALSE}
head(biodiversity)
```

```{r}
biodiversity %>% group_by(category) %>% summarise(n = n_distinct(state_conservation_rank))
biodiversity %>% summarise(n = n_distinct(global_conservation_rank))
```